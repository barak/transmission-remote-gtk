From: Benjamin Barenblat <bbaren@debian.org>
Date: Fri, 8 Apr 2022 13:12:27 +0100
Subject: Don't touch rss-glib if RSS is disabled

rss-glib is licensed under the LGPLv3 or later.  src/hig.c, src/hig.h,
src/torrent-cell-renderer.c, and src/torrent-cell-renderer.h are licensed under
the GPLv2 only.  Therefore, transmission-remote-gtk must be built without RSS to
avoid a GPL violation.

Disabling RSS with --without-libmrss should be enough to ensure this happens.
In the interest of defence in depth, however, conditionalize references to
rss-glib from within the build system.  As an added bonus, this speeds up build
time by not building code which will never get linked.

Author: Benjamin Barenblat <bbaren@mit.edu>
Bug: https://github.com/transmission-remote-gtk/transmission-remote-gtk/issues/21
---
 Makefile.am     | 5 ++++-
 src/Makefile.am | 6 ++++--
 2 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index dc8f3b3..2cfbac3 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -20,7 +20,10 @@
 ACLOCAL_AMFLAGS = -I m4
 AUTOMAKE_OPTIONS = foreign
 DISTCHECK_CONFIGURE_FLAGS = --disable-desktop-database-update
-SUBDIRS = extern src data po
+SUBDIRS = src data po
+if HAVE_RSS
+SUBDIRS += extern
+endif
 
 EXTRA_DIST = config.rpath  README.md
 
diff --git a/src/Makefile.am b/src/Makefile.am
index b257b75..a794972 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -145,8 +145,10 @@ noinst_HEADERS = \
 	  icon-turtle.h
 
 transmission_remote_gtk_CPPFLAGS = \
-	-DLOCALEDIR=\""$(localedir)"\" \
-	-I$(top_srcdir)/extern
+	-DLOCALEDIR=\""$(localedir)"\"
+if HAVE_RSS
+transmission_remote_gtk_CPPFLAGS += -I$(top_srcdir)/extern
+endif
 
 transmission_remote_gtk_CFLAGS = \
 	$(TRG_CFLAGS) \
